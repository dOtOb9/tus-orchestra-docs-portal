"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4402],{321:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>c,toc:()=>m});var a=n(4848),s=n(8453);const r={},o=void 0,c={id:"attendance-management-system/source/function/doGet",title:"doGet",description:"",source:"@site/docs/attendance-management-system/source/function/doGet.md",sourceDirName:"attendance-management-system/source/function",slug:"/attendance-management-system/source/function/doGet",permalink:"/tus-orchestra-docs-portal/docs/attendance-management-system/source/function/doGet",draft:!1,unlisted:!1,editUrl:"https://github.com/dOtOb9/tus-orchestra-docs-portal/tree/main/docs/attendance-management-system/source/function/doGet.md",tags:[],version:"current",frontMatter:{},sidebar:"attendanceManagementSystemSidebar",previous:{title:"\u95a2\u6570",permalink:"/tus-orchestra-docs-portal/docs/category/\u95a2\u6570-2"},next:{title:"doPost",permalink:"/tus-orchestra-docs-portal/docs/attendance-management-system/source/function/doPost"}},d={},m=[];function i(t){const e={code:"code",pre:"pre",...(0,s.R)(),...t.components};return(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-ts",metastring:'title="/src/main.ts"',children:"function doGet(e) {\n    const mode = e.parameter.mode;\n\n    let response_text: string;\n\n    switch (mode) {\n        case 'dashboard':\n            const normalAttendanceBook = new NormalAttendanceBook();\n            const tuttiAttendanceBook = new TuttiAttendanceBook();\n\n\n            const member = new Member(e.parameter.id);\n\n            const normalAttendRateStatus = member.attendanceStatus.getAttendRateStatus(normalAttendanceBook);\n            const tuttiAttendRateStatus = member.attendanceStatus.getAttendRateStatus(tuttiAttendanceBook);\n            \n            const dashboardHtml = HtmlService.createTemplateFromFile('src/views/dashboard');\n\n            dashboardHtml.attendanceNormalOverture = normalAttendRateStatus.overture.rate;\n            dashboardHtml.attendanceNormalMiddle = normalAttendRateStatus.middle.rate;\n            dashboardHtml.attendanceNormalMain = normalAttendRateStatus.main.rate;\n\n            dashboardHtml.attendanceTuttiOverture = tuttiAttendRateStatus.overture.rate;\n            dashboardHtml.attendanceTuttiMiddle = tuttiAttendRateStatus.middle.rate;\n            dashboardHtml.attendanceTuttiMain = tuttiAttendRateStatus.main.rate;\n\n            dashboardHtml.cssContent = HtmlService.createHtmlOutputFromFile('src/views/dashboard-css').getContent();\n            const dashboardHtmlOutput = dashboardHtml.evaluate();\n            return dashboardHtmlOutput;\n\n        case 'settingMeetingForm':\n            const htmlTemplate = HtmlService.createTemplateFromFile('src/views/setting-meeting-form');\n\n            htmlTemplate.cssContent = HtmlService.createHtmlOutputFromFile('src/views/setting-meeting-form-css').getContent();\n            return htmlTemplate.evaluate();\n\n        case 'user_data':\n            const user = new Member(e.parameter.id);\n            response_text = user.attendanceStatus.discordFormat();\n            return ContentService.createTextOutput(response_text);\n\n        case 'can_send_activity_dm':\n            const sheet = new AdminActivityBook().getMembersInfoSheet();\n\n            const contactListRows = sheet.getContactListRows();\n\n            let memberList = [];\n            \n            let part = [];\n\n            switch (e.parameter.type) {\n                case 'strings':\n                    part = ['Vn', 'Va', 'Vc', 'Cb'];\n                    break;\n\n                case 'brass':\n                    part = ['Tp', 'Hr', 'Trb'];\n                    break;\n\n                case 'woodwind':\n                    part = ['Fl', 'Ob', 'Cl', 'Fg'];\n                    break;\n\n                case 'percussion':\n                    part = ['Perc'];\n                    break;\n\n                case 'orchestra':\n                    part = ['Vn', 'Va', 'Vc', 'Cb', 'Tp', 'Hr', 'Trb', 'Fl', 'Fg', 'Ob', 'Cl', 'Perc'];\n            }\n\n            contactListRows.forEach(row => {\n                if (part.includes(row[3])) {\n                    memberList.push(row[2]);\n                }\n            });\n\n            const json = {\n                member_list: memberList\n            };\n\n            const response = JSON.stringify(json);\n            \n            return ContentService.createTextOutput(response);\n    }\n}\n"})})}function u(t={}){const{wrapper:e}={...(0,s.R)(),...t.components};return e?(0,a.jsx)(e,{...t,children:(0,a.jsx)(i,{...t})}):i(t)}},8453:(t,e,n)=>{n.d(e,{R:()=>o,x:()=>c});var a=n(6540);const s={},r=a.createContext(s);function o(t){const e=a.useContext(r);return a.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function c(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(s):t.components||s:o(t.components),a.createElement(r.Provider,{value:e},t.children)}}}]);