"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4402],{321:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>i,contentTitle:()=>d,default:()=>l,frontMatter:()=>o,metadata:()=>c,toc:()=>m});var a=n(4848),r=n(8453),s=n(5146);const o={},d=void 0,c={id:"attendance-management-system/source/function/doGet",title:"doGet",description:"---",source:"@site/docs/attendance-management-system/source/function/doGet.md",sourceDirName:"attendance-management-system/source/function",slug:"/attendance-management-system/source/function/doGet",permalink:"/tus-orchestra-docs-portal/docs/attendance-management-system/source/function/doGet",draft:!1,unlisted:!1,editUrl:"https://github.com/dOtOb9/tus-orchestra-docs-portal/tree/main/docs/attendance-management-system/source/function/doGet.md",tags:[],version:"current",frontMatter:{},sidebar:"attendanceManagementSystemSidebar",previous:{title:"\u95a2\u6570",permalink:"/tus-orchestra-docs-portal/docs/category/\u95a2\u6570-2"},next:{title:"doPost",permalink:"/tus-orchestra-docs-portal/docs/attendance-management-system/source/function/doPost"}},i={},m=[];function u(t){const e={code:"code",hr:"hr",pre:"pre",...(0,r.R)(),...t.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.A,{component:"doGet",type:"function",project:"attendance-management-system"}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-ts",metastring:'title="/src/main.ts"',children:"function doGet(e) {\n    const mode = e.parameter.mode;\n\n    let response_text: string;\n\n    switch (mode) {\n        case 'dashboard':\n            const stringsAttendanceBook = new StringsAttendanceBook();\n            const tuttiAttendanceBook = new TuttiAttendanceBook();\n\n\n            const member = new Member(e.parameter.id);\n\n            const stringsAttendRateStatus = member.attendanceStatus.getAttendRateStatus(stringsAttendanceBook);\n            const tuttiAttendRateStatus = member.attendanceStatus.getAttendRateStatus(tuttiAttendanceBook);\n            \n            const dashboardHtml = HtmlService.createTemplateFromFile('src/views/dashboard');\n\n            dashboardHtml.attendanceNormalOverture = stringsAttendRateStatus.overture.rate;\n            dashboardHtml.attendanceNormalMiddle = stringsAttendRateStatus.middle.rate;\n            dashboardHtml.attendanceNormalMain1 = stringsAttendRateStatus.main1.rate;\n            dashboardHtml.attendanceNormalMain2 = stringsAttendRateStatus.main2.rate;\n            dashboardHtml.attendanceNormalMain3 = stringsAttendRateStatus.main3.rate;\n            dashboardHtml.attendanceNormalMain4 = stringsAttendRateStatus.main4.rate;\n\n            dashboardHtml.attendanceTuttiOverture = tuttiAttendRateStatus.overture.rate;\n            dashboardHtml.attendanceTuttiMiddle = tuttiAttendRateStatus.middle.rate;\n            dashboardHtml.attendanceTuttiMain1 = tuttiAttendRateStatus.main1.rate;\n            dashboardHtml.attendanceTuttiMain2 = tuttiAttendRateStatus.main2.rate;\n            dashboardHtml.attendanceTuttiMain3 = tuttiAttendRateStatus.main3.rate;\n            dashboardHtml.attendanceTuttiMain4 = tuttiAttendRateStatus.main4.rate;\n\n            dashboardHtml.cssContent = HtmlService.createHtmlOutputFromFile('src/views/dashboard-css').getContent();\n            const dashboardHtmlOutput = dashboardHtml.evaluate();\n\n            dashboardHtmlOutput.addMetaTag('viewport', 'width=device-width, initial-scale=1')\n\n            return dashboardHtmlOutput;\n\n        case 'user_data':\n            const user = new Member(e.parameter.id);\n            response_text = user.attendanceStatus.discordFormat();\n            return ContentService.createTextOutput(response_text);\n\n        case 'can_send_activity_dm':\n            const sheet = new AdminBook().getMembersInfoSheet();\n\n            const contactListRows = sheet.getContactListRows();\n\n            let memberList: string[] = [];\n\n            if (e.parameter.type === 'custom') {\n                memberList = sheet.getCustomMemberList();\n            } else {\n\n                let part: string[] = [];\n    \n                switch (e.parameter.section) {\n                    case '\u5f26\u697d\u5668':\n                        part = ['Vn', 'Va', 'Vc', 'Cb'];\n                        break;\n    \n                    case '\u91d1\u7ba1\u697d\u5668':\n                        part = ['Tp', 'Hr', 'Trb'];\n                        break;\n    \n                    case '\u6728\u7ba1\u697d\u5668':\n                        part = ['Fl', 'Ob', 'Cl', 'Fg'];\n                        break;\n    \n                    case '\u6253\u697d\u5668':\n                        part = ['Perc'];\n                        break;\n    \n                    case 'Tutti':\n                        part = ['Vn', 'Va', 'Vc', 'Cb', 'Tp', 'Hr', 'Trb', 'Fl', 'Fg', 'Ob', 'Cl', 'Perc'];\n                }\n    \n                contactListRows.forEach(row => {\n                    if (part.includes(row[3])) {\n                        memberList.push(row[2]);\n                    }\n                });\n            }\n            \n\n            const json = {\n                member_list: memberList\n            };\n\n            const response = JSON.stringify(json);\n            \n            return ContentService.createTextOutput(response);\n    }\n}\n"})})]})}function l(t={}){const{wrapper:e}={...(0,r.R)(),...t.components};return e?(0,a.jsx)(e,{...t,children:(0,a.jsx)(u,{...t})}):u(t)}},9900:(t,e,n)=>{n.d(e,{A:()=>r});n(6540);var a=n(4848);const r=t=>{let{href:e,children:n,backgroundColor:r}=t;return(0,a.jsx)("a",{href:e,rel:"noopener noreferrer",style:{backgroundColor:r||"#25c2a0",borderRadius:"2px",color:"#fff",padding:"0.2rem"},children:n})}},5146:(t,e,n)=>{n.d(e,{A:()=>s});n(6540);var a=n(9900),r=n(4848);const s=t=>{let{component:e,type:n,project:s}=t;return(0,r.jsxs)("div",{children:[(0,r.jsx)(a.A,{href:`/tus-orchestra-docs-portal/docs/${s}/feature/${n}/${e}`,children:"\u6a5f\u80fd\u8a73\u7d30",backgroundColor:"#999900"}),(0,r.jsx)("span",{style:{margin:"5px"}}),(0,r.jsx)(a.A,{href:`/tus-orchestra-docs-portal/docs/${s}/philosophy/${n}/${e}`,children:"\u8a2d\u8a08\u601d\u60f3",backgroundColor:"#0080ff"})]})}},8453:(t,e,n)=>{n.d(e,{R:()=>o,x:()=>d});var a=n(6540);const r={},s=a.createContext(r);function o(t){const e=a.useContext(s);return a.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function d(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(r):t.components||r:o(t.components),a.createElement(s.Provider,{value:e},t.children)}}}]);