"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4086],{5760:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>o,default:()=>i,frontMatter:()=>r,metadata:()=>c,toc:()=>u});var s=n(4848),a=n(8453);const r={},o=void 0,c={id:"attendance-management-system/source/class/AttendanceSheet",title:"AttendanceSheet",description:"",source:"@site/docs/attendance-management-system/source/class/AttendanceSheet.md",sourceDirName:"attendance-management-system/source/class",slug:"/attendance-management-system/source/class/AttendanceSheet",permalink:"/tus-orchestra-docs-portal/docs/attendance-management-system/source/class/AttendanceSheet",draft:!1,unlisted:!1,editUrl:"https://github.com/dOtOb9/tus-orchestra-docs-portal/tree/main/docs/attendance-management-system/source/class/AttendanceSheet.md",tags:[],version:"current",frontMatter:{},sidebar:"attendanceManagementSystemSidebar",previous:{title:"AttendanceCodeSheet",permalink:"/tus-orchestra-docs-portal/docs/attendance-management-system/source/class/AttendanceCodeSheet"},next:{title:"AttendanceStatus",permalink:"/tus-orchestra-docs-portal/docs/attendance-management-system/source/class/AttendanceStatus"}},m={},u=[];function d(e){const t={code:"code",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",metastring:'title="/src/main.ts"',children:'class AttendanceSheet extends MemberSheet {\n    \n    override editMember(memberRow: Array<string>) {\n        const newRowNumber = this.data.length;\n        \n        // \u7df4\u7fd2\u56de\u6570\n        const activityNumber = `=COUNTIF(G${newRowNumber}:${newRowNumber}, "\u51fa\u5e2d")+COUNTIF(G${newRowNumber}:${newRowNumber}, "\u6b20\u5e2d")+COUNTIF(G${newRowNumber}:${newRowNumber}, "\u9045\u523b")+COUNTIF(G${newRowNumber}:${newRowNumber}, "\u65e9\u9000")`;\n        // \u51fa\u5e2d\u56de\u6570\n        const attendanceNumber = `=(COUNTIF(G${newRowNumber}:${newRowNumber}, "\u51fa\u5e2d"))+(COUNTIF(G${newRowNumber}:${newRowNumber}, "\u9045\u523b"))*0.5+(COUNTIF(G${newRowNumber}:${newRowNumber}, "\u65e9\u9000"))*0.5`;\n        // \u51fa\u5e2d\u7387\n        const attendanceRate = `=D${newRowNumber}/MAX(C${newRowNumber})`;\n        \n        // \u51fa\u6b20\u8868\u7528\u306e\u884c\u3092\u4f5c\u6210\u3059\u308b\n        const attendanceMemberRow = [memberRow[0], memberRow[1], activityNumber, attendanceNumber, attendanceRate, memberRow[2], memberRow[3]];\n        \n        super.editMember(attendanceMemberRow);\n    }\n    \n    public setActivityDate(date: string): number {\n        const dateColNumber = this.createColumnsLeft(date, 8, 1);\n        \n        return dateColNumber;\n    }\n    \n    public setAttend(id: string, datePos: number): boolean {\n        const memberRow = this.searchMember(id);\n        \n        const rowNumber = Number(memberRow[0]);\n        const colNumber = Number(this.data[0].length - 1 - datePos);\n        \n        if (this.data[rowNumber][colNumber] === "\u6b20\u5e2d") {\n            this.setValue(rowNumber, colNumber, "\u51fa\u5e2d");\n            \n            return true;\n        }\n        return false;\n    }\n    \n    public setAbsense(dateColNumber: number): void {\n        const values = Array(this.data.length-2).fill(["\u6b20\u5e2d"]);\n        this.setValues(\n            2, \n            this.data[0].length - 1 - dateColNumber, \n            this.data.length - 2,\n            1,\n            values\n        );\n    }\n    \n    public getMemberAttendanceRateAndBase(id: string) {\n        const MemberRow = this.searchMember(id);\n        \n        const rate = MemberRow[5];\n        const base = MemberRow[3];\n        \n        return { rate, base };\n    };\n}\n'})})}function i(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>c});var s=n(6540);const a={},r=s.createContext(a);function o(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);