"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4404],{6761:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>m,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var o=n(4848),r=n(8453),s=n(5146);const a={},c=void 0,i={id:"attendance-management-system/source/class/ScheduleSheet",title:"ScheduleSheet",description:"---",source:"@site/docs/attendance-management-system/source/class/ScheduleSheet.md",sourceDirName:"attendance-management-system/source/class",slug:"/attendance-management-system/source/class/ScheduleSheet",permalink:"/tus-orchestra-docs-portal/docs/attendance-management-system/source/class/ScheduleSheet",draft:!1,unlisted:!1,editUrl:"https://github.com/dOtOb9/tus-orchestra-docs-portal/tree/main/docs/attendance-management-system/source/class/ScheduleSheet.md",tags:[],version:"current",frontMatter:{},sidebar:"attendanceManagementSystemSidebar",previous:{title:"Property",permalink:"/tus-orchestra-docs-portal/docs/attendance-management-system/source/class/Property"},next:{title:"SetAttendance",permalink:"/tus-orchestra-docs-portal/docs/attendance-management-system/source/class/SetAttendance"}},d={},l=[];function u(e){const t={code:"code",hr:"hr",pre:"pre",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.A,{component:"ScheduleSheet",type:"class",project:"attendance-management-system"}),"\n",(0,o.jsx)(t.hr,{}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-ts",metastring:'title="/src/main.ts"',children:'class ScheduleSheet extends Sheet {\n    \n    // \u73fe\u5728\u306e\u7df4\u7fd2\u30b3\u30de\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n    public getNowTermRow(): Array<Array<string>> {\n        const today = new Today();\n        const todayText = today.toString();\n        const todayTimeArea = today.getTimeArea();\n        \n        const todayRows = this.data.filter(row => row[1] === todayText);\n        \n        const nowTermRows = todayRows.filter(row => {\n            if (todayTimeArea === "\u5348\u524d") {\n                return row[2] === "1" || row[2] === "2";\n            } else {\n                return row[2] === "3" || row[2] === "4";\n            }\n        })\n        \n        return nowTermRows;\n    }\n    \n    public setActivityDate(): void {\n        // \u5217\u540d\u304c\u7a7a\u767d\u306e\u884c\u3060\u3051\u53d6\u5f97\n        const noneSetDateRows = this.data.filter(row => row[4] === "");\n        \n        const noneSetStringsDateRows = noneSetDateRows.filter(row => row[5] === "Tutti");\n        const noneSetTuttiDateRows = noneSetDateRows.filter(row => row[5] !== "Tutti");\n        \n        // \u901a\u5e38\u7df4\u7fd2\u3001Tutti\u7df4\u7fd2\u3069\u3061\u3089\u3082\u5b9f\u884c\u3059\u308b\n        [noneSetStringsDateRows, noneSetTuttiDateRows].forEach((rows: Array<Array<string>>): void => {\n            // \u8ffd\u52a0\u3059\u308b\u5217\u304c\u306a\u3051\u308c\u3070\u7d42\u4e86\u3059\u308b\n            if (rows.length === 0) return;\n            \n            // Tutti\u5217\u306b\u30c1\u30a7\u30c3\u30af\u304c\u5165\u3063\u3066\u3044\u308b\u304b\u3001\u5165\u3063\u3066\u3044\u306a\u3044\u304b\u306e\u5224\u5b9a\n            const attendanceBook = rows[0][5] === "Tutti" ? new TuttiAttendanceBook() : new StringsAttendanceBook();\n            \n            rows.forEach((row) => {\n                // \u66f2\u540d\u304b\u3089\u5bfe\u8c61\u306e\u30b7\u30fc\u30c8\u3092\u53d6\u5f97\u3059\u308b\n                \n                const attendanceSheet = attendanceBook.getSheet(row[3]);\n                // \u65e5\u4ed8\u306e\u51fa\u6b20\u5217\u3092\u751f\u6210\u3057\u3001\u751f\u6210\u3057\u305f\u5217\u306e\u53f3\u7aef\u304b\u3089\u6570\u3048\u305f\u5217\u6570\u3092\u8fd4\u3059\n                const dateColNumber = attendanceSheet.setActivityDate(row[1]);\n                \n                // \u751f\u6210\u3057\u305f\u5217\u306e\u4f4d\u7f6e\u3092\u8a18\u9332\u3059\u308b\n                this.setValue(Number(row[0]), 4, dateColNumber.toString());\n            })\n        });\n    }\n    \n    public beginActivityDate(today: Today, membersInfoSheet: MembersInfoSheet): void {\n        const todayRows = this.data.filter(row => row[1] === today.toString());\n\n        const tuttiAttendanceBook = new TuttiAttendanceBook();\n        const stringsAttendanceBook = new StringsAttendanceBook();\n        \n        todayRows.forEach((row) => {\n            // Tutti\u5217\u306b\u30c1\u30a7\u30c3\u30af\u304c\u5165\u3063\u3066\u3044\u308b\u304b\u3001\u5165\u3063\u3066\u3044\u306a\u3044\u304b\u306e\u5224\u5b9a\n            const attendanceBook = row[5] === "Tutti" ? tuttiAttendanceBook : stringsAttendanceBook;\n            \n            // \u66f2\u540d\u304b\u3089\u5bfe\u8c61\u306e\u30b7\u30fc\u30c8\u3092\u53d6\u5f97\u3059\u308b\n            const attendanceSheet = attendanceBook.getSheet(row[3]);\n            \n            // \u5217\u540d\u304b\u3089\u5bfe\u8c61\u306e\u30b3\u30de\u5217\u3092\u53d6\u5f97\u3057\u3001\u5404\u30e6\u30fc\u30b6\u30fc\u306b\u6b20\u5e2d\u3092\u8a2d\u5b9a\u3059\u308b\n            attendanceSheet.setAbsense(Number(row[4]));\n\n            // \u964d\u308a\u756a\u306e\u5165\u529b\u3092\u3059\u308b\n            attendanceSheet.setOffMembers(Number(row[4]), membersInfoSheet);\n        });\n    }\n    \n    public isActivityDate(today: Today): boolean {\n        const todayRows = this.data.filter(row => row[1] === today.toString());\n        \n        return todayRows.length !== 0;\n    }\n    \n    public prepareActivityDate(date: string, section: string, slots: Array<string>): void {\n        for (let i = 0; i < slots.length; ++i) {\n            this.appendRow([date, (i+1).toString(), slots[i], "", section]);\n        }\n    }\n}\n'})})]})}function m(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}},9900:(e,t,n)=>{n.d(t,{A:()=>r});n(6540);var o=n(4848);const r=e=>{let{href:t,children:n,backgroundColor:r}=e;return(0,o.jsx)("a",{href:t,rel:"noopener noreferrer",style:{backgroundColor:r||"#25c2a0",borderRadius:"2px",color:"#fff",padding:"0.2rem"},children:n})}},5146:(e,t,n)=>{n.d(t,{A:()=>s});n(6540);var o=n(9900),r=n(4848);const s=e=>{let{component:t,type:n,project:s}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)(o.A,{href:`/tus-orchestra-docs-portal/docs/${s}/feature/${n}/${t}`,children:"\u6a5f\u80fd\u8a73\u7d30",backgroundColor:"#999900"}),(0,r.jsx)("span",{style:{margin:"5px"}}),(0,r.jsx)(o.A,{href:`/tus-orchestra-docs-portal/docs/${s}/philosophy/${n}/${t}`,children:"\u8a2d\u8a08\u601d\u60f3",backgroundColor:"#0080ff"})]})}},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>c});var o=n(6540);const r={},s=o.createContext(r);function a(e){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),o.createElement(s.Provider,{value:t},e.children)}}}]);