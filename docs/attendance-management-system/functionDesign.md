# 基本設計

## 1. 概要

**目的**  
本システムは、大学のオーケストラの練習および出欠管理を効率的に行うためのシステムです。出席率の集計やメンバーの出欠管理を自動化し、関係者に迅速に情報を提供することを目的としています。

**背景**  
従来の出欠管理方法では手作業が多く、エラーが発生しやすい問題がありました。これを解決するために、自動化された出欠管理システムを導入します。

## 2. システム構成

- **システムアーキテクチャ**:
  - Google Sheets をバックエンドとして使用し、Google Apps Script でカスタム機能を実装。
  - データは Google Sheets 上に保存され、スクリプトがデータ処理や管理を行います。
  - フロントエンドは HTML と CSS で構成され、TailwindCSSを活用します。Google Apps Script の `HtmlService` を使用して出席登録フォームを提供します。

- **主要コンポーネント**:
  - **Google Sheets**: データストレージおよび管理
  - **Google Apps Script**: スクリプトによるデータ処理
  - **HTML/CSS**: ユーザーインターフェースの提供

## 3. 機能要件

- **出欠管理**:
  - メンバーの出欠を管理し、出席率を計算します。
  - 出欠データは Google Sheets に記録され、メンバー毎に集計されます。

- **認証コード**:
  - 出席確認のための認証コードを生成し、メンバーに提供します。
  - 認証コードの生成・管理は Google Apps Script で行います。

- **出席登録フォーム**:
  - メンバーごとに出席登録を行うためのフォームを提供します。

## 4. 非機能要件

- **性能**:
  - 出席登録フォームの表示は、1秒以内に行えること。

- **セキュリティ**:
  - メンバーの個人情報や出欠データは、Google Sheets の権限設定により保護されること。
  - 認証コードの生成・管理は安全に行うこと。

- **ユーザビリティ**:
  - ユーザーインターフェースは直感的で使いやすいこと。
  - スマートフォンやタブレットでもアクセス可能であること。

## 5. データベース設計

- **メンバーデータ**:
  - テーブル: `Members`
    - カラム: `ID`, `Name`, `Part`, `Grade`, `AttendanceStatus`, `ContactList`

- **出欠データ**:
  - テーブル: `Attendance`
    - カラム: `ID`, `Date`, `Status`

## 6. ユーザーインターフェース設計

- **ダッシュボード**:
  - 出席率の表示
  - グラフやチャートを使用して出席状況を視覚化

- **フォーム**:
  - イベント情報設定フォーム
  - 出欠確認用フォーム

## 7. システムフロー

- **出欠管理フロー**:
　1. DiscordBotによる練習連絡の送信に伴い、GoogleSheetsのデータ更新
  2. 活動日当日に出欠列生成と認証コード情報の送信
  3. メンバーが認証コードを使用して出席登録
  4. スクリプトが出席データを Google Sheets に更新

- **イベント設定フロー**:
  1. イベント情報をフォームから入力
  2. スクリプトが Google Sheets に情報を保存

## 8. API設計

- **GET リクエスト**:
  - `/dashboard`: ダッシュボードの HTML を返す
  - `/user_data`: メンバーの出席状況を JSON 形式で返す

- **POST リクエスト**:
  - `/edit_user`: メンバー情報の編集
  - `/auth_attend`: 出席確認の処理
